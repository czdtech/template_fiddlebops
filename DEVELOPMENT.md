# 开发指南 (DEVELOPMENT GUIDE)

## 1. 项目概述 (Project Overview)

### 1.1 核心定位

- 项目类型：H5 游戏嵌入式 landing page
- 主要功能：通过 iframe 管理游戏容器及周边功能
- 技术栈：Astro + TypeScript + Tailwind CSS
- 包管理器：pnpm

### 1.2 关键原则

1. 静态生成优先
2. 最小必要功能
3. 渐进式优化
4. 不得修改现有样式
5. 移动端优先设计

### 1.3 项目结构

```
src/
├── components/      # 组件目录
│   └── sections/   # 页面区块组件
├── config/         # 配置文件
├── i18n/           # 国际化资源
│   └── translations/ # 翻译文件
├── pages/          # 页面文件
└── styles/         # 样式文件
```

## 2. 开发规范 (Development Standards)

### 2.1 代码提交规范

- 类型：
  - feat: 新功能（不涉及样式）
  - fix: 修复（不影响展现）
  - perf: 性能优化（保持样式）
  - refactor: 重构（确保视觉一致）
- 要求：
  - 每次提交前必须进行视觉回归测试
  - 提交信息必须符合 Conventional Commits 规范
  - 确保不影响现有样式和功能

### 2.2 依赖管理规范

- 添加依赖：
  \`\`\`bash
  pnpm add <package-name>
  \`\`\`
- 移除依赖：
  \`\`\`bash
  pnpm remove <package-name>
  \`\`\`
- 原则：
  - 仔细评估依赖必要性
  - 优先使用项目现有依赖
  - 确保版本兼容性

### 2.3 代码质量规范

- TypeScript：
  - 启用严格模式
  - 完整的类型定义
  - 避免 any 类型
- 组件开发：
  - 单一职责原则
  - 最小化副作用
  - 保持纯函数特性
- 样式管理：
  - 禁止修改现有样式
  - 使用 CSS 变量
  - 遵循 Tailwind 约定

## 3. 优化指南 (Optimization Guidelines)

### 3.0 优化原则

- 核心理念：

  - "过早优化是万恶之源" - Donald Knuth
  - 优化应以实际性能问题为导向
  - 避免预期性优化和过度工程

- 优化决策：

  - 必须有明确的性能问题和数据支持
  - 优化收益必须大于开发和维护成本
  - 保持代码的可读性和可维护性优先

- 优化限制：
  - 禁止为了微小性能提升而增加代码复杂度
  - 避免过早的性能优化
  - 不牺牲代码质量和可维护性换取细微的性能提升

### 3.1 性能优化

- 构建优化：
  - 代码分割
  - Tree Shaking
  - 资源压缩
- 运行时优化：
  - 减少重排重绘
  - 优化事件处理
  - 资源预加载
- 缓存策略：
  - 静态资源缓存
  - CDN 优化
  - 版本化管理

### 3.2 样式优化

- CSS 变量系统：
  - 语义化命名
  - 功能分组
  - 主题支持
- 选择器优化：
  - 降低嵌套深度
  - 优先使用类选择器
  - 合并媒体查询
- 动画性能：
  - 使用 transform/opacity
  - 避免重排属性
  - 适当使用 will-change

### 3.3 国际化优化

- 文本管理：
  - 集中式翻译文件
  - 动态语言切换
  - 格式化支持
- SEO 优化：
  - 多语言元标签
  - 语言版本链接
  - 结构化数据

## 4. 测试规范 (Testing Standards)

### 4.1 必要测试

- 视觉回归测试：
  - 优化前后对比
  - 跨浏览器测试
  - 响应式测试
- 性能测试：
  - Lighthouse 审计
  - Web Vitals 指标
  - 负载测试

### 4.2 监控要求

- 错误监控：
  - 前端异常捕获
  - 性能指标跟踪
  - 用户行为分析
- 性能监控：
  - LCP (Largest Contentful Paint)
  - FID (First Input Delay)
  - CLS (Cumulative Layout Shift)

## 5. AI 辅助开发指南 (AI Development Guidelines)

### 5.1 代码生成约束

- 必须遵循：
  - TypeScript 类型安全
  - Astro 组件规范
  - 项目现有架构
- 禁止事项：
  - 修改现有样式
  - 改变组件结构
  - 违反性能原则

### 5.2 代码审查重点

- 检查项目：
  - 类型定义完整性
  - 组件复用性
  - 性能影响
  - 样式一致性
- 优化建议：
  - 基于现有架构
  - 保持向后兼容
  - 符合项目规范

### 5.3 文档生成规范

- 格式要求：
  - 清晰的层次结构
  - 统一的格式标准
  - 详细的示例说明
- 内容要求：
  - 实现原理说明
  - 使用方法指导
  - 注意事项标注

## 6. 发布流程 (Release Process)

### 6.1 预发布检查

- 代码检查：
  - TypeScript 编译通过
  - ESLint 检查通过
  - 代码格式化完成
- 测试验证：
  - 单元测试通过
  - 视觉回归测试通过
  - 性能指标达标

### 6.2 发布步骤

1. 版本更新
2. 更新日志生成
3. 构建优化
4. 部署验证
5. 监控确认

### 6.3 发布后确认

- 功能验证
- 性能监控
- 错误跟踪
- 用户反馈收集

## 7. 注意事项 (Important Notes)

### 7.1 关键约束

1. 严格保持项目结构
2. 禁止修改现有样式
3. 持续性能优化
4. 保持依赖最小化

### 7.2 开发提示

1. 优先使用现有工具和组件
2. 确保国际化支持完整
3. 及时更新文档
4. 定期进行性能测试

### 7.3 常见陷阱

1. 样式修改影响
2. 性能退化
3. 依赖冲突
4. 类型定义不完整
5. 过度优化陷阱：
   - 过分追求性能指标而牺牲代码质量
   - 为了微小性能收益增加不必要的复杂性
   - 在没有性能问题的地方进行预优化
   - 过度抽象和封装导致代码难以维护

### 7.4 优化平衡原则

- 性能与可维护性平衡：
  - 优先考虑代码的可读性和可维护性
  - 只在有实际性能问题时进行优化
  - 保持简单直接的解决方案
- 优化投资回报：
  - 评估优化成本与收益比
  - 关注对用户体验有实质影响的优化
  - 避免过度追求完美的性能指标

## 8. 附录 (Appendix)

### 8.1 有用的命令

\`\`\`bash

# 开发

pnpm dev

# 构建

pnpm build

# 测试

pnpm test

# 类型检查

pnpm type-check
\`\`\`

### 8.2 相关资源

- Astro 文档: [链接]
- TypeScript 文档: [链接]
- Tailwind 文档: [链接]
- 项目 Wiki: [链接]
